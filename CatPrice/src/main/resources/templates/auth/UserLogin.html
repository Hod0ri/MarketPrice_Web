<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>ğŸ± ì‹œì„¸ë¥¼ RGo10ë‹¤</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&display=swap" rel="stylesheet">
  <link rel="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <script src="https://code.jquery.com/jquery-3.6.1.js" integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"></script>
</head>

<body>
<div th:replace="fragments/header.html :: fragment-header"></div>
<div style="text-align: center;font-family: 'Do Hyeon', sans-serif;">
  <h3>ê³ ëƒ¥ì´ ê´€ë¦¬ì ë¡œê·¸ì¸</h3>
  <p>ê³ ëƒ¥ì´ ì„œë²„ ê´€ë¦¬ì ë¡œê·¸ì¸ í˜ì´ì§€ì…ë‹ˆë‹¤.</p>
  <div style="width:80%;margin-left: auto;margin-right: auto;">
    <div class="input-group mb-3" id="div_id">
      <span class="input-group-text" style="width: 20%">ë¡œê·¸ì¸ ID</span>
      <input type="text" class="form-control" placeholder="ë¡œê·¸ì¸ ID" aria-describedby="basic-addon1" id="user_id">
    </div>
    <div class="input-group mb-3">
      <span class="input-group-text" style="width: 20%" id="div_passwd">ë¹„ë°€ë²ˆí˜¸</span>
      <input type="password" class="form-control" placeholder="ë¹„ë°€ë²ˆí˜¸" aria-describedby="basic-addon1" id="user_password">
    </div>
    <p style="color: darkred" id="loginStatus"></p>
    <button type="button" class="btn btn-secondary" name="submitBtn">ê´€ë¦¬ì ë¡œê·¸ì¸</button>
  </div>
  <script type="text/javascript">
  </script>
</div>
<script type="text/javascript">

  $(document).ready(function () {

    const address = "http://money.catmc.kr"

    $("#user_id").change(function () {
      let user_id = $(this).val();

      if (user_id == "") {
        $("#div_id").css("border", "1px solid red");
      } else {
        $("#div_id").css("border", "none");
      }
    })

    $("#user_passwd").change(function () {
      let password = $(this).val();

      if (password === "") {
        $("#div_password").css("border", "1px solid red");
      } else {
        $("#div_password").css("border", "none");
      }
    })

    $("button[name='submitBtn']").click(function () {
        let user_id = $("#user_id").val();
        let user_password =  $("#user_password").val();

        if (user_id === "" || user_password === "") {
          alert("ëª¨ë“  ì¹¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
        } else {
          // AJAX GET request
          $.ajax({
            type: 'GET',
            url: address + "/authapi/login?user_id=" + user_id + "&password=" + user_password,
            contentType: "application/json",
            dataType: 'text',
            success: function (data) {

            },
            error: function () {
            },
            complete: function (data) {
              let result = data['responseText'];

              if(result === 'cannotfindid') {
                $("#loginStatus").text("ì•„ì´ë””ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
              } else if(result === 'authexception') {
                $("#loginStatus").text("ê³„ì • ì •ë³´ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")
              } else if(result === 'successful') {
                window.location = address;
              }

            }
          });
        }

    });
  });
</script>

<div th:replace="fragments/footer.html :: fragment-footer"></div>
</body>
</html>